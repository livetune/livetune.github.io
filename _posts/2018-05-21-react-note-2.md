---
layout: post
title: react学习笔记2
categories: react
description: 《深入浅出react和redux》的笔记
keywords: react,学习笔记
---
# 继续记录每章的学习，初识flux和redux

## Flux

增加多几个文件夹：view(存放视图js)、store(存放变量的js)

1.导入Dispatcher，并返回一个Dispatcher对象。

```js
\\ AppDispatcher.js
import {Dispatcher} from {flux}
export default new Dispatcher()
```

2.定义一个action，使action函数调用一次Dispatcher.dispatchfe

```js
\\ ActionTypes.js
export const INCREMENT='increment'

\\ Actions.js

import * as ActionTypes from './ActionTypes.js'
import AppDispatcher from ’. / AppDispatcher.js ’;
export const increment = (counterCaption) => {
    AppDispatcher.dispatch({
    type: ActionTypes.INCREMENT,
    counterCaption: counterCaption});
};
```

3.在Store管理变量，有多个Store对象，Store对象继承EventEmitter，使用事件来管理。

```js
import AppDispatcher from '../AppDispatcher.js';

CounterStore.dispatchToken = AppDispatcher.register (( action) => {
    // 由于register函数无法限制action的输入,当Dispatcher分发一次，Dispatcher会执行register所绑定的回调函数，所以需要使用if/else或者switch/case来选择使用哪一个action
    if (action.type === ActionTypes.INCREMENT ) {
        counterValues[action.counterCaption]++;
        CounterStore.emitChange ();
    }
});
```

4.在view中调用Action。

```js
  onClickIncrementButton() {
    Actions.increment(this.props.caption);
  }
```

## Redux

使用react与使用flux有些不同。

1. 唯一数据源，不需要建立Store文件夹来存放数据。
2. Action中不需要调用dispatch函数，只需要返回一个对象。初始化则是将调用createStore(render,initValues),render为Render.js返回的对象。

```js
\\ Reduce.js 替代AppDispatcher.js
import * as ActionTypes from './ActionTypes.js';

export default (state, action) => {
  const {counterCaption} = action;

  switch (action.type) {
    case ActionTypes.INCREMENT:
      return {...state, [counterCaption]: state[counterCaption] + 1};
    case ActionTypes.DECREMENT:
      return {...state, [counterCaption]: state[counterCaption] - 1};
    default:
      return state
  }
}

\\ Store.js
import {createStore} from 'redux';
import reducer from './Reducer.js';

const initValues = {
  'First': 0,
  'Second': 10,
  'Third': 20
};

const store = createStore(reducer, initValues);

export default store;
```

